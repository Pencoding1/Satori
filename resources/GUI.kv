#:kivy 2.0.0
#:import utils kivy.utils
#:import cache cache
#:import os os

<Donate>:
	title: cache.content[19]
	title_size: self.width / 20
	title_font: 'resources/SVN-Have Heart 2.ttf'
	title_align: 'center'
	title_color: utils.get_color_from_hex('#ca3741')
	separator_color: utils.get_color_from_hex('#ffffff')
	background: 'resources/popup.png'
	size_hint:[.8, .9]
	auto_dismiss: False
	
	BoxLayout:
		orientation: 'vertical'
		
		Lbl_top:
			size_hint_y: .15
			color: utils.get_color_from_hex('#000000')
			text: cache.content[20]
			font_size: self.width / 25
		
		Img:
			source: 'resources/reimu.zip'
			anim_delay: .03
			size_hint_y: .7
			
		Label:
			size_hint_y: .05
			
		Btn:
			id: btn
			text: 'OK'
			on_release: root.dismiss()
			size_hint: [.2, .1]
			disable: True
			pos_hint: {'center_x': .5}
			color: utils.get_color_from_hex('#c077a4')

<Memory>:
	title: cache.content[18]
	title_size: self.width / 20
	title_align: 'center'
	title_font: 'resources/SVN-Have Heart 2.ttf'
	title_color: utils.get_color_from_hex('#c077a4')
	separator_color: utils.get_color_from_hex('#ffffff')
	background: 'resources/popup.png'
	size_hint:[.6, .9]
	auto_dismiss: False
	
	BoxLayout:
		orientation: 'vertical'
		
		Img:
			source: 'resources/memory.png'
			size_hint_y: .85
			
		Label:
			size_hint_y: .05
			
		Btn:
			text: 'OK'
			on_release: root.dismiss()
			size_hint: [.2, .1]
			pos_hint: {'center_x': .5}
			color: utils.get_color_from_hex('#c077a4')
			
<Pefect>:
	title: cache.content[17]
	title_size: self.width / 20
	title_align: 'center'
	title_color: utils.get_color_from_hex('#ffffff')
	title_font: 'resources/SVN-Have Heart 2.ttf'
	separator_color: utils.get_color_from_hex('#ca3741')
	background: 'resources/crino.png'
	size_hint:[.7, .9]
	auto_dismiss: False
	
	BoxLayout:
		orientation: 'vertical'
		
		Img:
			source: 'resources/crino.zip'
			size_hint_y: .85
			anim_delay: .01
			
		Label:
			size_hint_y: .05
			
		Btn:
			text: 'OK'
			on_release: root.dismiss()
			size_hint: [.2, .1]
			pos_hint: {'center_x': .5}
			color: utils.get_color_from_hex('#0c78c1')

<Gift>:
	title: cache.content[12]
	title_size: self.width / 20
	title_align: 'center'
	title_color: utils.get_color_from_hex('#c077a4')
	separator_color: utils.get_color_from_hex('#ffffff')
	title_font: 'resources/SVN-Have Heart 2.ttf'
	background: 'resources/popup.png'
	size_hint:[.5, .8]
	auto_dismiss: False
	
	BoxLayout:
		orientation: 'vertical'
		
		Lbl_top:
			text: cache.content[13]
			size_hint_y: .1
			font_size: self.width / 20
		Img:
			source: 'resources/gift.png'
			size_hint_y: .5
			
		Lbl:
			text: '\n'.join(cache.content[14:17])
			size_hint_y: .3
			font_size: self.width / 20
			
		Btn:
			text: 'OK'
			on_release: root.dismiss()
			size_hint: [.3, .1]
			pos_hint: {'center_x': .5}

<Result>:
	name: 'result'
	lbl0: lbl0
	btn: btn
	lbl1: lbl1
	on_pre_enter: self.callback()
	on_enter: self.callback1()
		
	Bg:
	
	BoxLayout:
		orientation: 'horizontal'
		
		BoxLayout:
			size_hint_x: .6
			orientation: 'vertical'
			padding: 10
			
			Lbl_top:
				id: lbl0
				size_hint_y: .3
				
			Lbl_top:
				id: lbl1
				font_name: 'resources/SVN-Hemi Head.ttf'
				size_hint_y: .3
			
			Label:
				#Một label trống để tạo khoảng cách giữa button và label trong BoxLayout.
				#An empty label to create space between button and labels in the BoxLayout.
				size_hint_y: .2
			
			Btn:
				id: btn
				size_hint: [.5, .1]
				pos_hint: {'center_x':.5}
				on_release: root.callback0()
				font_size: self.height / 2
				
			Label:
				size_hint_y: .1
				
		Img:
			source: 'resources/portrait1.png'
			size_hint_x: .4
				
<Loading>:
	name: 'loading'
	on_pre_enter: self.callback1()
	on_enter: self.callback()
	img: img
		
	AnchorLayout:
		anchor_y: 'center'
		
		Img:
			id: img
			size_hint_y:  None
				#Bằng việc đặt size_hint_y thành None sẽ khiến ảnh bị cắt xén theo chiều dọc nhưng sẽ luôn lấp đầy màn hình ngang.
				#By setting size_hint_y to None will cause the image cropped by vertical but will always fill horizontal monitor.
			source: cache.img_source
		
<Menu>:
	name: 'menu'
	lbl: lbl
	btn: btn
	speaker: speaker
	on_pre_enter: self.callback()
	
	Bg:

	BoxLayout:
		orientation: 'horizontal'
		
		BoxLayout:
			orientation: 'vertical'
			padding: [20, 0, 50, 50]
			
			Img:
				source: 'resources/heading.png'
				
			Lbl:
				id: lbl
				font_size: self.width / 22
				
			BoxLayout:
				size_hint_y: .4
				orientation: 'horizontal'
			
				Btn:	
					id: btn
					size_hint_y: .5
					on_release: root.callback0(True)
					
				Label:
					#Dùng label trống dễ và chính xác hơn là dùng pos_hint. Hoặc tại tôi ngu. Nhưng nó sẽ không gây ảnh hưởng gì lắm nhỉ ?
					#Using empty label is easier and more accuraty than using pos_hint. Or maybe because I'm dumb. But it isn't affect, is it ?
					size_hint_x: .5
				
				Spn:
					text: 'Language'
					size_hint_y: .5
					values: cache.languages
					on_text:
						cache.change_lang(self.text)
						root.callback0(False)
						
		Img:
			source: 'resources/portrait0.png'
			size_hint_x: .6
			
	AnchorLayout:
		anchor_x: 'left'
		anchor_y: 'top'
		
		Speaker:
			id: speaker
			on_state: 
				root.callback1(self.state)
				app.music_ctrl()

<Ask>:
	on_pre_enter: self.callback()
	temp: None
	img: img
	lbl0: lbl0
	lbl1: lbl1
	btn0: btn0
	btn1: btn1
	
	Bg:
	
	BoxLayout:
		orientation: 'horizontal'
				
		BoxLayout:
			orientation: 'vertical'
				
			Lbl_top:
				id: lbl0
				size_hint_y: .3
				
			Lbl:
				id: lbl1
				size_hint: [.9, .2]
				pos_hint: {'center_x': .5}
				
			Label:
				size_hint_y: .3
			
			BoxLayout:
				size_hint_y: .1
				orientation: 'horizontal'
				
				Label:
					size_hint_x: .05
				
				Btn:
					id: btn0
					size_hint_x: .3
					on_release: root.callback0(True)
					
				Label:
					size_hint_x: .3
					
				Btn:
					id: btn1
					size_hint_x: .3
					on_release: root.callback0(False)
				
				Label:
					size_hint_x: .05
			
			Label:
				size_hint_y: .1
				
		Img:
			id: img
	
	AnchorLayout:
		anchor_x: 'left'
		anchor_y: 'top'
		
		Home:
			on_release: root.callback2()

<Final>:
	#Tôi đã cố để tạo mẫu thay vì copy code như thế này. Nhưng nó phát sinh rất nhiều lỗi và tốn công hơn so với việc ctrl + c và ctrl + v.
	#I tried to create template instead of copying code like this. But it's super buggy and cost more than ctrl + c and ctrl + v.
	on_pre_enter: self.callback()
	img: img
	lbl0: lbl0
	lbl1: lbl1
	btn0: btn0
	btn1: btn1
	
	Bg:
	
	BoxLayout:
		orientation: 'horizontal'
				
		BoxLayout:
			orientation: 'vertical'
				
			Lbl_top:
				id: lbl0
				size_hint_y: .3
				
			Lbl:
				id: lbl1
				size_hint: [.9, .2]
				pos_hint: {'center_x': .5}
				
			Label:
				size_hint_y: .3
			
			BoxLayout:
				size_hint_y: .1
				orientation: 'horizontal'
				
				Label:
					size_hint_x: .05
				
				Btn:
					id: btn0
					size_hint_x: .3
					on_release: root.callback0(True)
					
				Label:
					size_hint_x: .3
					
				Btn:
					id: btn1
					size_hint_x: .3
					on_release: root.callback0(False)
				
				Label:
					size_hint_x: .05
			
			Label:
				size_hint_y: .1
				
		Img:
			id: img
			
	AnchorLayout:
		anchor_x: 'left'
		anchor_y: 'top'
		
		Home:
			on_release: root.callback2()

Root:

<Root@ScreenManager>:
	Loading:
		name: 'loading'
	Menu:
		name: 'menu'
	Ask:
		name: 'ask0'
		temp: 'ask1'
	Ask:
		name: 'ask1'
		temp: 'ask0'
	Final:
		name: 'final'
	Result:
		name: 'result'
			
<Btn@Button>:
	font_name: 'resources/SVN-Hemi Head.ttf'
	font_size: self.height / 2
	background_normal: 'resources/button_normal.png'
	background_down: 'resources/button_down.png'
	color: utils.get_color_from_hex('#c077a4')
	size: self.texture_size
	
<Spn_option@SpinnerOption+Btn>:
	font_size: self.width / 10
	background_down:'resources/spinner_down.png'
	background_normal: 'resources/spinner_normal.png'
	height: self.font_size * 2
	
<Spn@Spinner+Btn>:
	option_cls: 'Spn_option'
	background_normal: 'resources/spinner_normal.png'
	background_down: 'resources/spinner_down.png'
	sync_height: True

<Img@Image>:
	allow_stretch: True
	size: self.texture_size

<Bg@FloatLayout>:
	#Dùng canvas vẽ một phông nền đơn giản.
	#Use canvas to draw a simple background.
	canvas.before:
		Color:
			rgba: utils.get_color_from_hex('#dcf0fb')
		Rectangle:
			size: self.size
			pos: self.pos
			
<Lbl_top@Label>:
	font_name: 'resources/UTM Deutsch Gothic.ttf'
	color: utils.get_color_from_hex('#f96466')
	font_size: self.width / 10
			
<Bg_lbl@Widget>:
	canvas.before:
		Rectangle:
			size: self.size
			pos: self.pos
			source: 'resources/texture.png'
	
<Lbl@Bg_lbl+Lbl_top>:
	#Ýe, label với 1 phông nền sếch xi.
	#Yes, label with a sexy background.
	font_name: 'resources/SFUBelleRegular.ttf'
	color: utils.get_color_from_hex('#000000')
	font_size: self.width / 20
	size: self.texture_size
	halign: 'center'
	valign: 'middle'
	
<Speaker@ToggleButtonBehavior+Img>:
	source: 'resources/speaker.png'
	size_hint: [.1, .1]
	allow_no_selection: False
	
<Home@ButtonBehavior+Img>:
	source: 'resources/home.png'
	size_hint: [.1, .1]